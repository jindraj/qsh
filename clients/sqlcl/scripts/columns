#!/bin/bash

QUERY_CUSTOMIZATION=$2

cat <<EOF > $1
select * from (
	select (case when t.TABLE_TYPE = 'TABLE' then 'BASE TABLE' else 'VIEW' end) as TABLE_TYPE,
         user as TABLE_SCHEMA, c.TABLE_NAME, c.COLUMN_NAME,
         c.COLUMN_ID as ORDINAL_POSITION, c.DATA_DEFAULT as COLUMN_DEFAULT, c.NULLABLE as IS_NULLABLE,
         c.DATA_TYPE, c.CHAR_LENGTH as CHARACTER_MAXIMUM_LENGTH, DATA_PRECISION as NUMERIC_PRECISION,
         c.DATA_SCALE as NUMERIC_SCALE
	from USER_TAB_COLUMNS c
	inner join USER_TAB_COMMENTS t on c.TABLE_NAME = t.TABLE_NAME
  order by 2, 3, 5
) t
$QUERY_CUSTOMIZATION;
EOF

